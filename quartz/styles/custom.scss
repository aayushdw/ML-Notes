@use "./base.scss";

// ============================================
// RETROMA GROOVY THEME - TEAL VARIANT
// Ported from Obsidian Retroma theme
// ============================================

// Custom Retroma variables
:root {
  // Groovy variant: groove/ridge borders, 3D shadows
  --retroma-border-width: 4px;
  --retroma-border-radius: 12px;
  --retroma-shadow-depth: 4px;

  // Heading color spectrum (H1-H6: red through violet)
  --heading-h1: #dc2626;
  --heading-h2: #ea580c;
  --heading-h3: #ca8a04;
  --heading-h4: #16a34a;
  --heading-h5: #0891b2;
  --heading-h6: #7c3aed;

  // Emphasis colors
  --bold-color: var(--dark);
  --italic-color: var(--secondary);

  // Groove/ridge border colors (light mode)
  --groove-light: rgba(255, 255, 255, 0.7);
  --groove-dark: rgba(0, 0, 0, 0.25);

  // Inset/outset shadows
  --inset-shadow: inset 2px 2px 4px rgba(0, 0, 0, 0.1),
    inset -1px -1px 3px rgba(255, 255, 255, 0.5);
  --outset-shadow: 2px 2px 4px rgba(0, 0, 0, 0.15),
    -1px -1px 3px rgba(255, 255, 255, 0.3);
}

:root[saved-theme="dark"] {
  // Dark mode groove/ridge adjustments
  --groove-light: rgba(255, 255, 255, 0.15);
  --groove-dark: rgba(0, 0, 0, 0.5);

  --inset-shadow: inset 2px 2px 4px rgba(0, 0, 0, 0.4),
    inset -1px -1px 3px rgba(255, 255, 255, 0.05);
  --outset-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5),
    -1px -1px 3px rgba(255, 255, 255, 0.05);
}

// ============================================
// HEADINGS - Color Spectrum
// ============================================

article {
  h1 {
    color: var(--heading-h1);
    border-bottom: var(--retroma-border-width) ridge var(--heading-h1);
    padding-bottom: 0.5rem;

    &>a[data-role="anchor"] {
      color: var(--heading-h1);
    }
  }

  h2 {
    color: var(--heading-h2);
    border-bottom: 3px groove var(--heading-h2);
    padding-bottom: 0.4rem;

    &>a[data-role="anchor"] {
      color: var(--heading-h2);
    }
  }

  h3 {
    color: var(--heading-h3);
    border-left: var(--retroma-border-width) solid var(--heading-h3);
    padding-left: 0.75rem;

    &>a[data-role="anchor"] {
      color: var(--heading-h3);
    }
  }

  h4 {
    color: var(--heading-h4);

    &>a[data-role="anchor"] {
      color: var(--heading-h4);
    }
  }

  h5 {
    color: var(--heading-h5);

    &>a[data-role="anchor"] {
      color: var(--heading-h5);
    }
  }

  h6 {
    color: var(--heading-h6);
    font-style: italic;

    &>a[data-role="anchor"] {
      color: var(--heading-h6);
    }
  }
}

// ============================================
// TYPOGRAPHY EMPHASIS
// ============================================

article {
  strong {
    color: var(--bold-color);
    font-weight: 700;
  }

  em {
    color: var(--italic-color);
  }

  // Bold + Italic combination
  strong em,
  em strong {
    color: var(--secondary);
    font-weight: 700;
  }
}

// ============================================
// GROOVE/RIDGE BORDER EFFECTS (Groovy Variant)
// ============================================

// Blockquotes with groove effect
blockquote {
  border-left: var(--retroma-border-width) groove var(--secondary);
  border-radius: 0 var(--retroma-border-radius) var(--retroma-border-radius) 0;
  background: linear-gradient(to right, rgba(13, 115, 119, 0.05), transparent);
  padding: 1rem 1.25rem;
  box-shadow: var(--inset-shadow);
}

:root[saved-theme="dark"] blockquote {
  background: linear-gradient(to right, rgba(45, 212, 191, 0.05), transparent);
}

// Code blocks with ridge borders
pre {
  border: var(--retroma-border-width) ridge var(--lightgray);
  border-radius: var(--retroma-border-radius);
  box-shadow: var(--inset-shadow);

  &:has(> code.mermaid) {
    border: none;
    box-shadow: none;
  }
}

// Inline code
code:not(pre code) {
  border: 1px solid var(--lightgray);
  border-radius: 4px;
  box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.05);
}

// Tables with groove borders
.table-container>table {
  border: var(--retroma-border-width) groove var(--lightgray);
  border-radius: var(--retroma-border-radius);
  overflow: hidden;
  box-shadow: var(--outset-shadow);

  th {
    background: var(--lightgray);
    border-bottom: 3px ridge var(--gray);
  }

  td {
    border-bottom: 1px groove var(--lightgray);
  }

  tr:last-child td {
    border-bottom: none;
  }
}

// ============================================
// SHADOW EFFECTS FOR DEPTH
// ============================================

// Callouts with 3D effect
.callout {
  border: var(--retroma-border-width) ridge var(--border);
  border-radius: var(--retroma-border-radius);
  box-shadow: var(--outset-shadow);

  .callout-title {
    border-bottom: 2px groove var(--border);
    margin-bottom: 0.5rem;
  }
}

// Search container
.search>.search-button {
  border: 2px groove var(--lightgray);
  border-radius: 8px;
  box-shadow: var(--outset-shadow);
  transition: box-shadow 0.2s ease, transform 0.1s ease;

  &:hover {
    box-shadow: var(--inset-shadow);
    transform: translateY(1px);
  }

  &:active {
    box-shadow: var(--inset-shadow);
    transform: translateY(2px);
  }
}

// Images with frame effect
article img {
  border: 3px ridge var(--lightgray);
  border-radius: var(--retroma-border-radius);
  box-shadow: var(--outset-shadow);
}

// Explorer folder styling
.explorer-content .folder-outer>ul {
  border-left: 2px groove var(--lightgray);
}

// ============================================
// LINK STYLING
// ============================================

a {
  color: var(--secondary);
  text-decoration: none;
  transition: color 0.2s ease, text-shadow 0.2s ease;

  &:hover {
    color: var(--tertiary);
    text-shadow: 0 0 1px var(--tertiary);
  }

  &.internal {
    background-color: var(--highlight);
    border-radius: 4px;
    padding: 0.1rem 0.3rem;
    border-bottom: 2px solid transparent;
    transition: border-color 0.2s ease, background-color 0.2s ease;

    &:hover {
      border-bottom-color: var(--tertiary);
    }

    &:has(> img) {
      background-color: transparent;
      border: none;
      padding: 0;
    }
  }

  &.external {
    &::after {
      opacity: 0.6;
      transition: opacity 0.2s ease;
    }

    &:hover::after {
      opacity: 1;
    }
  }
}

// Tag links
a.internal.tag-link {
  background: linear-gradient(135deg, var(--highlight), rgba(13, 115, 119, 0.08));
  border: 1px solid var(--secondary);
  border-radius: 12px;
  padding: 0.15rem 0.5rem;
  font-size: 0.9em;

  &:hover {
    border-color: var(--tertiary);
  }
}

:root[saved-theme="dark"] a.internal.tag-link {
  background: linear-gradient(135deg,
      var(--highlight),
      rgba(45, 212, 191, 0.08));
}

// ============================================
// CHECKBOX STYLING
// ============================================

input[type="checkbox"] {
  width: 18px;
  height: 18px;
  border: 2px groove var(--secondary);
  border-radius: 4px;
  background-color: var(--light);
  box-shadow: var(--inset-shadow);
  cursor: pointer;
  transition: all 0.15s ease;

  &:hover {
    border-color: var(--tertiary);
    box-shadow: 0 0 4px var(--tertiary);
  }

  &:checked {
    background-color: var(--secondary);
    border-color: var(--secondary);
    box-shadow: var(--inset-shadow);

    &::after {
      content: "";
      position: absolute;
      left: 5px;
      top: 1px;
      width: 5px;
      height: 10px;
      border: solid var(--light);
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
  }
}

// Completed task styling
li:has(> input[type="checkbox"]:checked) {
  text-decoration: line-through;
  text-decoration-color: var(--gray);
  color: var(--gray);
}

// ============================================
// SIDEBAR & NAVIGATION
// ============================================

// Explorer styling
.explorer {

  button.desktop-explorer,
  button.mobile-explorer {
    border-bottom: 2px groove var(--lightgray);
    padding-bottom: 0.5rem;

    h2 {
      color: var(--secondary);
    }
  }
}

// Table of Contents
.toc {
  button.toc-header {
    border-bottom: 2px groove var(--lightgray);
    padding-bottom: 0.5rem;

    h3 {
      color: var(--secondary);
    }
  }

  ul.toc-content>li>a {
    transition: color 0.2s ease, padding-left 0.2s ease;

    &:hover,
    &.in-view {
      color: var(--secondary);
      padding-left: 0.25rem;
    }
  }
}

// Backlinks
.backlinks {
  h3 {
    color: var(--secondary);
    border-bottom: 2px groove var(--lightgray);
    padding-bottom: 0.5rem;
  }
}

// Graph container
.graph {
  border: 2px groove var(--lightgray);
  border-radius: var(--retroma-border-radius);
  box-shadow: var(--inset-shadow);
  overflow: hidden;
}

// ============================================
// DIVIDERS
// ============================================

hr {
  height: 4px;
  background: linear-gradient(to right,
      transparent,
      var(--lightgray),
      var(--gray),
      var(--lightgray),
      transparent);
  border: none;
  border-top: 2px groove var(--lightgray);
  border-bottom: 2px ridge var(--lightgray);
  margin: 2rem auto;
}

.footnotes {
  border-top: 3px groove var(--lightgray);
  padding-top: 1.5rem;
}

// ============================================
// POPOVER STYLING
// ============================================

.popover {
  border: 2px ridge var(--lightgray);
  border-radius: var(--retroma-border-radius);
  box-shadow: var(--outset-shadow);
}

// ============================================
// BREADCRUMBS
// ============================================

.breadcrumb-container {
  .breadcrumb-element {
    color: var(--secondary);

    &:hover {
      color: var(--tertiary);
    }
  }
}

// ============================================
// LATEX / KATEX - Center Alignment
// ============================================

// Center block-level KaTeX math (display mode)
// Center block-level KaTeX math (display mode)
.katex-display {
  display: block !important;
  text-align: center !important;
  width: 100%;
  margin: 1em 0;
  overflow-x: auto;
  overflow-y: hidden;

  >.katex {
    display: inline-block !important;
    text-align: center;
  }
}

// Style paragraphs that contain ONLY block math (no text siblings)
// This class is added by katex-block.inline.ts at runtime
p.katex-block-paragraph {
  display: block;
  text-align: center;
  width: 100%;
  margin: 1em 0;

  >.katex {
    display: inline-block;
  }
}

// Center Typst/other math displays
.math.math-display {
  display: flex;
  justify-content: center;
  width: 100%;
}